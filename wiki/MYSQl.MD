# ШПАРГАЛКА MYSQL

## РАБОТА MYSQL SERVER С ФАЙЛАМИ

### ВЫГРУЗКА БАЗЫ ДАННЫХ В SQL ФАЙЛ

```
mysqldump -u<user> -p<password> <options> <database> > <file>
```

**Где**: \
`<user>` - имя пользователя \
`<password>` - пароль пользвателя \
`<database>` - имя БД, которую необхдимо выгрузить \
`<options>` - дополнительные параметры выгрузки таблицы, например, для полной выгрузки базы данных
со всеми триггерамми и тд. вместо <options> может использоваться: `--events --triggegrs --routines`. \
`<file>` - файл, в который будет выгружен скрипт создания базы данных (поддерживается относительный путь)



**Возможные <options>**:
`--no-data` - выгрузка модели базы данных **без самих данных**; \
`--no-create-info` - выгрузка скрипта для восстановления данных,
без модели базы данных; \


### ЗАГРУЗКА ДАННЫХ ТАБЛИЦЫ ИЗ ФАЙЛА НА КОМПЬЮТЕРЕ

1. Входим на сервер
2. Изменяем значение переменной `local_infile=1`:

		set global local_infile=1;

3. Выходим из сервера
4. Заходим на сервер с помощью локальной системной переменной:

		mysql --local-infile=1 -u<user> -p<password> <database>;

5. Загружаем базу данных из .txt файла: 

		load data local infile '<path_to_file>' into table <table_name>;


### ВЫГРУЗКА ДАННЫХ ТАБЛИЦЫ В ФАЙЛ

**Перед тем как выполнять действия по извлечению данных из таблицы, необходимо
выбрать соответствующую базу данных.**

В результате выполнения следующей команды будет создан текстовый файл в том виде,
в котором его можно загрузить в таблицу БД:

	SELECT * FROM <table_name> INTO OUTFILE '<full_path_to_output_file>';

Так же можно изменить формат выгружаемого файла для лучшей совместимости, например:

	SELECT * FROM <table_name> INTO OUTFILE '<full_path_to_output_file>'
		FIELDS TERMINATED BY ',' ENCLOSED BY '"'
		LINES TERMINATED BY '\r\n';


### ВЫГРУЗКА МОДЕЛИ ТАБЛИЦЫ

В данном случае произойдёт импорт *модели таблицы из базы данных*, иными словами `.sql` скрипт
для создания таблицы данной структуры.

	mysqldump -u<user> -p<password> --tab="<full_path_to_directory>" <database> <table>

Где `<full_path_to_directory>` - путь до папки, в которую сохранится файл скрипта.
Имя файлу(ам) даётся автоматически.


### ЗАГРУЗКА ТАБЛИЦЫ В БАЗУ ДАННЫХ ИЗ ФАЙЛА SQL

	mysql -u<login> -p<password> <database_name> < "<full_path_to_file>"


## УПРАВЛЯЮЩИЕ ЗАПРОСЫ MYSQL


### Основные команды

#### Выбор базы данных
```
use <database>;
```

#### Показать спиисок баз данных
```
show databases;
```

#### Показать спиисок таблиц в базе данных
Показывает список таблиц, содержащихся в базе данных.
```
show tables;
```
> Работает, если выбрана база данных.

#### Показать структуру (модель) таблицы.
Показывает объектную модель таблицы (типы данных колонок, имена колонок, наличие первичных ключей и других параметров таблицы)
```
show create table <table>;
```
**Где** `<table>` - имя таблицы, модель которой мы хотим получить.

#### Изменение имени (переименование) таблицы

```
 alter table `<old>` rename to `<new>`
```
**Где**: \
`<old>` - старое имя таблицы \
`<new>` - новое имя таблицы.


#### Изменение имени (переименование) столбца таблицы

```
 alter table rename column `<old>` to `<new>`
```
**Где**: \
`<old>` - старое имя столбца \
`<new>` - новое имя столбца.


#### Заполнение таблицы (данных таблицы) вручную

```
insert into <table>(`<column0>`, ...,) values ('<value0>', ...,), ('<value0>', ...,);
```

**Где** \
`<table>` - имя таблицы, в которую мы добавляем значения; \
`<column0>` - заголовок столбца, (может быть несколько), для которого мы будем передавать значения; \
`<value0>` - значение столбца (может быть несколько), передаваемое в колонку соответствующую по
порядку; \
`('<value0>', ...,)` - строка значений.

> Строк значений может быть несколько `('<value0>', ...,)` - перечисляются через запятую.
> Эти строки значений соответстуют строкам таблицы (данным таблицы).
> Если некоторые столбцы имеют `AUTO_INCREMENT` - их можно игнорировать при заполнении талицы
> (не передавать вручную <columnN> и <valueN>).

#### Изменение колонки таблицы

```
alter table `<table>` modify `<column>` <parameters>;
```

**Где**: \
`<table>` - имя изменяемой таблицы; \
`<column>` - имя изменяемого столбца в этой таблице; \
`<parameters>` - параметры изменения, например: `varchar(8) not null after id`.


#### Изменение значений в таблице

```
update <table> set <column0>=<value0>, ...,;
```

**Где** \
`<table>` - имя таблицы, в которую мы добавляем значения;
`<column0>` - заголовок колонки, (может быть несколько), для которой мы будем передавать значения;
`<value0>` - значение строки (может быть несколько), передаваемое в колонку соответствующую по
порядку.


#### Добавление в таблицу внешнего ключа

```
alter table `<table>` add foreign key (`<key0>`, ...) references `<another_table>` (`<column0>`, ...);
```

**Где**: \
`<table>` - таблица, в которую мы добавляем внешний ключ; \
`<key0>` - имя столбца, который должен стать первичным ключом
(их может быть несколько, должны быть перечислены через запятую); \
`<another_table>` - имя таблицы, на столбец которой должен ссылаться внешний ключ; \
`<column0>` - столбец таблицы, на который должен ссылаться внешний ключ
(их может быть несколько, должны быть перечислены через запятую).


## ОБРАЩЕНИЕ К СИСТЕМНЫМ ПЕРЕМЕННЫМ

- Просмотр значения: `select @@global.<global_variable>;`
- Установка значения: `set @@global.<global_variable>=<value>;`


# USERS #
login: 		emb
password: 	367as
role: 		db admin


mysqldump -uroot -proot --no-create-info --tab="C:\ProgramData\MySQL\MySQL Server 8.0\Uploads" schedule schedule